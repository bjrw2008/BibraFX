<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BibraFX Admin - Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6366f1;
      --primary-dark: #4f46e5;
      --secondary: #f8fafc;
      --accent: #f59e0b;
      --text: #1e293b;
      --text-light: #64748b;
      --border: #e2e8f0;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
      --sidebar-width: 280px;
      --header-height: 70px;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: #f1f5f9;
      color: var(--text);
      line-height: 1.6;
    }

    /* Auth Styles */
    .auth-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
    }

    .auth-card {
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: var(--shadow-lg);
      width: 100%;
      max-width: 400px;
    }

    .auth-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .auth-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .auth-logo i {
      font-size: 2rem;
      color: var(--primary);
    }

    .auth-logo span {
      font-size: 1.5rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .auth-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 8px;
    }

    .auth-subtitle {
      color: var(--text-light);
      font-size: 0.9rem;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--text);
      font-size: 0.9rem;
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: white;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
      width: 100%;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
      box-shadow: var(--shadow);
    }

    .btn-secondary {
      background: var(--secondary);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: #e2e8f0;
    }

    .btn-danger {
      background: var(--error);
      color: white;
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    .btn-success {
      background: var(--success);
      color: white;
    }

    .btn-success:hover {
      background: #059669;
    }

    .btn-sm {
      padding: 8px 16px;
      font-size: 0.875rem;
    }

    /* Admin Layout */
    .admin-layout {
      display: none;
      min-height: 100vh;
    }

    .sidebar {
      width: var(--sidebar-width);
      background: white;
      border-right: 1px solid var(--border);
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 24px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .sidebar-logo {
      font-size: 1.5rem;
      color: var(--primary);
    }

    .sidebar-brand {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text);
    }

    .nav-section {
      padding: 16px 0;
    }

    .nav-title {
      padding: 0 24px 12px 24px;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 24px;
      color: var(--text-light);
      text-decoration: none;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .nav-item:hover, .nav-item.active {
      background: #f8fafc;
      color: var(--primary);
      border-left-color: var(--primary);
    }

    .nav-item i {
      width: 20px;
      text-align: center;
    }

    .main-content {
      margin-left: var(--sidebar-width);
      padding: 20px;
      min-height: 100vh;
    }

    .header {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 24px;
      display: flex;
      justify-content: between;
      align-items: center;
    }

    .header-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text);
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .user-info {
      text-align: right;
    }

    .user-name {
      font-weight: 600;
      color: var(--text);
    }

    .user-role {
      font-size: 0.875rem;
      color: var(--text-light);
    }

    .logout-btn {
      background: none;
      border: none;
      color: var(--text-light);
      cursor: pointer;
      padding: 8px;
      border-radius: 6px;
      transition: all 0.3s ease;
    }

    .logout-btn:hover {
      background: var(--secondary);
      color: var(--error);
    }

    /* Dashboard Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .stat-icon {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }

    .stat-icon.primary {
      background: rgba(99, 102, 241, 0.1);
      color: var(--primary);
    }

    .stat-icon.success {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }

    .stat-icon.warning {
      background: rgba(245, 158, 11, 0.1);
      color: var(--warning);
    }

    .stat-icon.error {
      background: rgba(239, 68, 68, 0.1);
      color: var(--error);
    }

    .stat-info h3 {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }

    .stat-info p {
      color: var(--text-light);
      font-size: 0.875rem;
    }

    /* Content Area */
    .content-card {
      background: white;
      border-radius: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 24px;
      overflow: hidden;
    }

    .card-header {
      padding: 24px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: between;
      align-items: center;
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text);
    }

    .card-body {
      padding: 24px;
    }

    /* Form Styles */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }

    .full-width {
      grid-column: 1 / -1;
    }

    .form-section {
      margin-bottom: 32px;
    }

    .section-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--primary);
    }

    .subject-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }

    .subject-option {
      padding: 16px;
      border: 2px solid var(--border);
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: white;
    }

    .subject-option:hover {
      border-color: var(--primary);
      background: #f8fafc;
    }

    .subject-option.selected {
      border-color: var(--primary);
      background: var(--primary);
      color: white;
    }

    .subject-option.forex {
      border-color: #f59e0b;
    }

    .subject-option.forex.selected {
      background: #f59e0b;
      color: white;
    }

    .tag-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }

    .tag {
      background: var(--primary);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.875rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .tag-remove {
      cursor: pointer;
      font-weight: bold;
    }

    .preview-container {
      margin-top: 16px;
      padding: 16px;
      background: #f8fafc;
      border-radius: 8px;
      border: 2px dashed var(--border);
    }

    .preview-container iframe {
      width: 100%;
      height: 400px;
      border: 1px solid var(--border);
      border-radius: 8px;
    }

    .thumbnail-preview {
      max-width: 200px;
      max-height: 150px;
      margin-top: 10px;
      border-radius: 8px;
      border: 2px solid var(--border);
      display: none;
    }

    /* Table Styles */
    .table-container {
      overflow-x: auto;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th,
    .data-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    .data-table th {
      background: #f8fafc;
      font-weight: 600;
      color: var(--text);
      font-size: 0.875rem;
    }

    .data-table tr:hover {
      background: #f8fafc;
    }

    .badge {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .badge-primary {
      background: rgba(99, 102, 241, 0.1);
      color: var(--primary);
    }

    .badge-success {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }

    .badge-warning {
      background: rgba(245, 158, 11, 0.1);
      color: var(--warning);
    }

    .badge-error {
      background: rgba(239, 68, 68, 0.1);
      color: var(--error);
    }

    /* Status Messages */
    .status {
      padding: 12px 16px;
      border-radius: 8px;
      margin-top: 16px;
      font-weight: 500;
    }

    .status.success {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
      border: 1px solid rgba(16, 185, 129, 0.2);
    }

    .status.error {
      background: rgba(239, 68, 68, 0.1);
      color: var(--error);
      border: 1px solid rgba(239, 68, 68, 0.2);
    }

    .status.info {
      background: rgba(99, 102, 241, 0.1);
      color: var(--primary);
      border: 1px solid rgba(99, 102, 241, 0.2);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }
      
      .sidebar.active {
        transform: translateX(0);
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .mobile-menu-btn {
        display: block;
      }
    }

    .mobile-menu-btn {
      display: none;
      background: none;
      border: none;
      font-size: 1.25rem;
      color: var(--text);
      cursor: pointer;
    }

    /* Loading States */
    .loading {
      opacity: 0.6;
      pointer-events: none;
    }

    .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid transparent;
      border-top: 2px solid currentColor;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Authentication Section -->
  <div id="authSection" class="auth-container">
    <div class="auth-card">
      <div class="auth-header">
        <div class="auth-logo">
          <i class="fas fa-chart-line"></i>
          <span>BibraFX</span>
        </div>
        <h1 class="auth-title">Admin Dashboard</h1>
        <p class="auth-subtitle">Sign in to manage your content</p>
      </div>
      
      <form id="loginForm">
        <div class="form-group">
          <label class="form-label" for="email">Email Address</label>
          <input type="email" id="email" class="form-input" placeholder="admin@bibrafx.com" required>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="password">Password</label>
          <input type="password" id="password" class="form-input" placeholder="Enter your password" required>
        </div>
        
        <button type="submit" class="btn btn-primary" id="loginBtn">
          <i class="fas fa-sign-in-alt"></i>
          Sign In
        </button>
      </form>
      
      <div id="authStatus" class="status" style="display: none; margin-top: 16px;"></div>
    </div>
  </div>

  <!-- Admin Dashboard -->
  <div id="adminSection" class="admin-layout">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <i class="fas fa-chart-line sidebar-logo"></i>
        <span class="sidebar-brand">BibraFX Admin</span>
      </div>
      
      <nav class="nav-section">
        <div class="nav-title">Main</div>
        <a href="#" class="nav-item active" data-tab="dashboard">
          <i class="fas fa-home"></i>
          Dashboard
        </a>
        <a href="#" class="nav-item" data-tab="addDocument">
          <i class="fas fa-plus-circle"></i>
          Add Document
        </a>
        <a href="#" class="nav-item" data-tab="manageDocuments">
          <i class="fas fa-file-alt"></i>
          Manage Documents
        </a>
      </nav>
      
      <nav class="nav-section">
        <div class="nav-title">Settings</div>
        <a href="#" class="nav-item" data-tab="users">
          <i class="fas fa-users"></i>
          Users
        </a>
        <a href="#" class="nav-item" data-tab="settings">
          <i class="fas fa-cog"></i>
          Settings
        </a>
      </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Header -->
      <div class="header">
        <div>
          <button class="mobile-menu-btn">
            <i class="fas fa-bars"></i>
          </button>
          <h1 class="header-title" id="pageTitle">Dashboard</h1>
        </div>
        
        <div class="user-menu">
          <div class="user-info">
            <div class="user-name" id="userName">Admin User</div>
            <div class="user-role">Administrator</div>
          </div>
          <button class="logout-btn" id="logoutBtn" title="Sign Out">
            <i class="fas fa-sign-out-alt"></i>
          </button>
        </div>
      </div>

      <!-- Dashboard Tab -->
      <div id="dashboardTab" class="tab-content active">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon primary">
              <i class="fas fa-file-pdf"></i>
            </div>
            <div class="stat-info">
              <h3 id="totalDocuments">0</h3>
              <p>Total Documents</p>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon success">
              <i class="fas fa-coins"></i>
            </div>
            <div class="stat-info">
              <h3 id="forexDocuments">0</h3>
              <p>Forex Documents</p>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon warning">
              <i class="fas fa-users"></i>
            </div>
            <div class="stat-info">
              <h3 id="totalUsers">1</h3>
              <p>Active Users</p>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon error">
              <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-info">
              <h3 id="recentActivity">0</h3>
              <p>Recent Activity</p>
            </div>
          </div>
        </div>

        <div class="content-card">
          <div class="card-header">
            <h2 class="card-title">Recent Documents</h2>
          </div>
          <div class="card-body">
            <div id="recentDocuments">
              <p class="text-muted">No recent documents</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Document Tab -->
      <div id="addDocumentTab" class="tab-content">
        <div class="content-card">
          <div class="card-header">
            <h2 class="card-title">Add New Document</h2>
          </div>
          <div class="card-body">
            <form id="documentForm">
              <div class="form-section">
                <h3 class="section-title">Basic Information</h3>
                <div class="form-grid">
                  <div class="full-width">
                    <label class="form-label" for="docTitle">Document Title *</label>
                    <input type="text" id="docTitle" class="form-input" placeholder="e.g., Advanced Forex Trading Strategies">
                    <div class="small text-muted mt-1" id="slugPreview">Slug will be generated automatically</div>
                  </div>

                  <div class="full-width">
                    <label class="form-label" for="docDescription">Detailed Description</label>
                    <textarea id="docDescription" class="form-input" rows="4" placeholder="Provide a comprehensive description of this educational material..."></textarea>
                  </div>

                  <div class="full-width">
                    <label class="form-label">Subject Area *</label>
                    <div class="subject-grid">
                      <div class="subject-option forex selected" data-value="forex-trading">
                        <i class="fas fa-coins"></i>
                        Forex Trading
                      </div>
                      <div class="subject-option forex" data-value="technical-analysis">
                        <i class="fas fa-chart-line"></i>
                        Technical Analysis
                      </div>
                      <div class="subject-option forex" data-value="fundamental-analysis">
                        <i class="fas fa-globe-americas"></i>
                        Fundamental Analysis
                      </div>
                      <div class="subject-option forex" data-value="risk-management">
                        <i class="fas fa-shield-alt"></i>
                        Risk Management
                      </div>
                      <div class="subject-option forex" data-value="trading-psychology">
                        <i class="fas fa-brain"></i>
                        Trading Psychology
                      </div>
                      <div class="subject-option" data-value="computer-science">
                        <i class="fas fa-laptop-code"></i>
                        Computer Science
                      </div>
                      <div class="subject-option" data-value="mathematics">
                        <i class="fas fa-calculator"></i>
                        Mathematics
                      </div>
                      <div class="subject-option" data-value="economics">
                        <i class="fas fa-chart-bar"></i>
                        Economics
                      </div>
                      <div class="subject-option" data-value="business">
                        <i class="fas fa-briefcase"></i>
                        Business
                      </div>
                    </div>
                    <input type="hidden" id="docSubject" value="forex-trading">
                  </div>

                  <div>
                    <label class="form-label" for="docType">Document Type *</label>
                    <select id="docType" class="form-input">
                      <option value="ebook">üìñ E-Book</option>
                      <option value="trading-guide">üìã Trading Guide</option>
                      <option value="research-paper">üî¨ Research Paper</option>
                      <option value="lecture-notes">üìù Lecture Notes</option>
                      <option value="cheatsheet">üéØ Cheat Sheet</option>
                    </select>
                  </div>

                  <div>
                    <label class="form-label" for="docDifficulty">Difficulty Level</label>
                    <select id="docDifficulty" class="form-input">
                      <option value="beginner">üë∂ Beginner</option>
                      <option value="intermediate">üéØ Intermediate</option>
                      <option value="advanced">üî• Advanced</option>
                      <option value="expert">‚ö° Expert</option>
                    </select>
                  </div>

                  <div>
                    <label class="form-label" for="docPages">Number of Pages</label>
                    <input type="number" id="docPages" class="form-input" placeholder="150" min="1">
                  </div>

                  <div>
                    <label class="form-label" for="docFileSize">File Size (MB)</label>
                    <input type="number" id="docFileSize" class="form-input" step="0.1" placeholder="4.5" min="0.1">
                  </div>

                  <div>
                    <label class="form-label" for="docLanguage">Language</label>
                    <select id="docLanguage" class="form-input">
                      <option value="english">üá∫üá∏ English</option>
                      <option value="spanish">üá™üá∏ Spanish</option>
                      <option value="french">üá´üá∑ French</option>
                      <option value="arabic">üá∏üá¶ Arabic</option>
                    </select>
                  </div>

                  <div>
                    <label class="form-label" for="docAuthor">Author / Source</label>
                    <input type="text" id="docAuthor" class="form-input" placeholder="Trading Expert, Financial Institution...">
                  </div>
                </div>
              </div>

              <div class="form-section">
                <h3 class="section-title">Forex Specific Details</h3>
                <div class="form-grid">
                  <div>
                    <label class="form-label" for="docTimeframe">Recommended Timeframe</label>
                    <select id="docTimeframe" class="form-input">
                      <option value="">Any Timeframe</option>
                      <option value="scalping">‚è±Ô∏è Scalping (1M-15M)</option>
                      <option value="day-trading">üìÖ Day Trading (1H-4H)</option>
                      <option value="swing-trading">üìä Swing Trading (4H-D1)</option>
                      <option value="position-trading">üìà Position Trading (W1-MN)</option>
                    </select>
                  </div>

                  <div>
                    <label class="form-label" for="docCurrencyPairs">Main Currency Pairs</label>
                    <input type="text" id="docCurrencyPairs" class="form-input" placeholder="EUR/USD, GBP/JPY, XAU/USD">
                  </div>

                  <div>
                    <label class="form-label" for="docPublishedDate">Published Date</label>
                    <input type="date" id="docPublishedDate" class="form-input">
                  </div>

                  <div>
                    <label class="form-label" for="docRating">Quality Rating (1-5)</label>
                    <select id="docRating" class="form-input">
                      <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent</option>
                      <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Very Good</option>
                      <option value="3">‚≠ê‚≠ê‚≠ê Good</option>
                      <option value="2">‚≠ê‚≠ê Average</option>
                      <option value="1">‚≠ê Basic</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="form-section">
                <h3 class="section-title">Content & Media</h3>
                <div class="form-grid">
                  <div class="full-width">
                    <label class="form-label" for="docTags">Trading Tags (comma separated)</label>
                    <input type="text" id="docTags" class="form-input" placeholder="price action, fibonacci, risk management...">
                    <div class="tag-container" id="tagContainer"></div>
                  </div>

                  <div class="full-width">
                    <label class="form-label" for="docPdfUrl">PDF Document URL *</label>
                    <input type="url" id="docPdfUrl" class="form-input" placeholder="https://drive.google.com/... or direct PDF link">
                  </div>

                  <div class="full-width">
                    <label class="form-label" for="docThumbnailUrl">Thumbnail Image URL (Optional)</label>
                    <input type="url" id="docThumbnailUrl" class="form-input" placeholder="https://example.com/thumbnail.jpg">
                    <img id="thumbnailPreview" class="thumbnail-preview" alt="Thumbnail preview">
                  </div>

                  <div class="full-width">
                    <label class="form-label" for="docKeyPoints">Key Learning Points (one per line)</label>
                    <textarea id="docKeyPoints" class="form-input" rows="4" placeholder="‚Ä¢ Understand market structure&#10;‚Ä¢ Learn risk management techniques&#10;‚Ä¢ Master entry and exit strategies"></textarea>
                  </div>

                  <div class="full-width">
                    <label class="form-label" for="docPrerequisites">Prerequisites / Required Knowledge</label>
                    <textarea id="docPrerequisites" class="form-input" rows="3" placeholder="Basic understanding of forex markets..."></textarea>
                  </div>
                </div>
              </div>

              <!-- PDF Preview -->
              <div class="form-section">
                <h3 class="section-title">Document Preview</h3>
                <div class="preview-container" id="previewContainer" style="display: none;">
                  <div class="small text-muted mb-2">Document Preview:</div>
                  <iframe id="pdfPreview" src=""></iframe>
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary" id="saveDocumentBtn">
                  <i class="fas fa-save"></i>
                  Save Document
                </button>
                <button type="button" class="btn btn-secondary" id="clearFormBtn">
                  <i class="fas fa-broom"></i>
                  Clear Form
                </button>
              </div>
            </form>

            <div id="formStatus" class="status" style="display: none;"></div>
          </div>
        </div>
      </div>

      <!-- Manage Documents Tab -->
      <div id="manageDocumentsTab" class="tab-content">
        <div class="content-card">
          <div class="card-header">
            <h2 class="card-title">Manage Documents</h2>
            <div class="header-actions">
              <input type="text" id="searchDocuments" class="form-input" placeholder="Search documents..." style="width: 300px;">
            </div>
          </div>
          <div class="card-body">
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Title</th>
                    <th>Category</th>
                    <th>Type</th>
                    <th>Difficulty</th>
                    <th>Rating</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="documentsTable">
                  <tr>
                    <td colspan="6" class="text-center text-muted">Loading documents...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase and App Script -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
  
  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCEnxXqUX5SjuNZA8Oi1egYocKEa5ujI6o",
      authDomain: "bibra-f-x.firebaseapp.com",
      projectId: "bibra-f-x",
      storageBucket: "bibra-f-x.firebasestorage.app",
      messagingSenderId: "675110251274",
      appId: "1:675110251274:web:1d7b9a2568dcd89123a8f3",
      measurementId: "G-QT5S9HRBQ3"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Admin credentials (in production, use Firebase Auth with custom claims)
    const ADMIN_EMAIL = "admin@bibrafx.com";
    const ADMIN_PASSWORD = "admin123";

    // App State
    let currentUser = null;
    let allDocuments = [];

    // DOM Elements
    const authSection = document.getElementById('authSection');
    const adminSection = document.getElementById('adminSection');
    const loginForm = document.getElementById('loginForm');
    const loginBtn = document.getElementById('loginBtn');
    const authStatus = document.getElementById('authStatus');
    const logoutBtn = document.getElementById('logoutBtn');
    const userName = document.getElementById('userName');

    // Initialize App
    document.addEventListener('DOMContentLoaded', function() {
      initializeAuth();
      initializeEventListeners();
      setDefaultDate();
    });

    // Authentication Functions
    function initializeAuth() {
      auth.onAuthStateChanged((user) => {
        if (user && user.email === ADMIN_EMAIL) {
          currentUser = user;
          showAdminPanel();
          loadDashboardData();
        } else {
          showAuthPanel();
        }
      });
    }

    function showAuthPanel() {
      authSection.style.display = 'flex';
      adminSection.style.display = 'none';
      currentUser = null;
    }

    function showAdminPanel() {
      authSection.style.display = 'none';
      adminSection.style.display = 'flex';
      userName.textContent = currentUser.email;
    }

    // Event Listeners
    function initializeEventListeners() {
      // Auth
      loginForm.addEventListener('submit', handleLogin);
      logoutBtn.addEventListener('click', handleLogout);

      // Navigation
      document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', handleNavigation);
      });

      // Document Form
      document.getElementById('documentForm').addEventListener('submit', handleSaveDocument);
      document.getElementById('clearFormBtn').addEventListener('click', clearDocumentForm);
      document.getElementById('docTitle').addEventListener('input', updateSlugPreview);
      document.getElementById('docPdfUrl').addEventListener('input', updatePdfPreview);
      document.getElementById('docThumbnailUrl').addEventListener('input', updateThumbnailPreview);
      document.getElementById('docTags').addEventListener('input', updateTagDisplay);

      // Subject Selection
      document.querySelectorAll('.subject-option').forEach(option => {
        option.addEventListener('click', handleSubjectSelection);
      });

      // Search
      document.getElementById('searchDocuments').addEventListener('input', filterDocuments);
    }

    // Authentication Handlers
    async function handleLogin(e) {
      e.preventDefault();
      
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      if (!email || !password) {
        showAuthStatus('Please enter both email and password', 'error');
        return;
      }

      if (email !== ADMIN_EMAIL || password !== ADMIN_PASSWORD) {
        showAuthStatus('Invalid admin credentials', 'error');
        return;
      }

      try {
        loginBtn.innerHTML = '<div class="spinner"></div> Signing In...';
        loginBtn.disabled = true;

        // For demo purposes, we'll use a simple check
        // In production, use Firebase Auth with proper admin setup
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
          showAuthStatus('Login successful! Redirecting...', 'success');
          setTimeout(() => {
            currentUser = { email: email };
            showAdminPanel();
            loadDashboardData();
          }, 1000);
        }
      } catch (error) {
        showAuthStatus('Login failed: ' + error.message, 'error');
      } finally {
        loginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Sign In';
        loginBtn.disabled = false;
      }
    }

    function handleLogout() {
      currentUser = null;
      showAuthPanel();
      showAuthStatus('You have been signed out', 'info');
    }

    function showAuthStatus(message, type) {
      authStatus.textContent = message;
      authStatus.className = `status ${type}`;
      authStatus.style.display = 'block';
      
      setTimeout(() => {
        authStatus.style.display = 'none';
      }, 5000);
    }

    // Navigation
    function handleNavigation(e) {
      e.preventDefault();
      
      // Update active nav item
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      this.classList.add('active');

      // Show corresponding tab
      const tabName = this.getAttribute('data-tab');
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      const targetTab = document.getElementById(tabName + 'Tab');
      if (targetTab) {
        targetTab.classList.add('active');
        document.getElementById('pageTitle').textContent = this.textContent.trim();
      }

      // Load data for the tab
      if (tabName === 'manageDocuments') {
        loadDocumentsTable();
      } else if (tabName === 'dashboard') {
        loadDashboardData();
      }
    }

    // Dashboard Functions
    async function loadDashboardData() {
      try {
        // Load document counts
        const categories = ['forex-trading', 'technical-analysis', 'fundamental-analysis', 'risk-management', 'trading-psychology'];
        let totalCount = 0;
        let forexCount = 0;

        for (const category of categories) {
          const snapshot = await db.collection(category).get();
          const count = snapshot.size;
          totalCount += count;
          if (category === 'forex-trading') {
            forexCount = count;
          }
        }

        document.getElementById('totalDocuments').textContent = totalCount;
        document.getElementById('forexDocuments').textContent = forexCount;
        document.getElementById('totalUsers').textContent = '1'; // Static for demo
        document.getElementById('recentActivity').textContent = totalCount;

        // Load recent documents
        await loadRecentDocuments();
      } catch (error) {
        console.error('Error loading dashboard data:', error);
      }
    }

    async function loadRecentDocuments() {
      try {
        const container = document.getElementById('recentDocuments');
        const categories = ['forex-trading', 'technical-analysis'];
        
        let recentDocs = [];
        for (const category of categories) {
          const snapshot = await db.collection(category)
            .orderBy('createdAt', 'desc')
            .limit(5)
            .get();
          
          snapshot.forEach(doc => {
            recentDocs.push({ id: doc.id, category, ...doc.data() });
          });
        }

        // Sort by date and take top 5
        recentDocs.sort((a, b) => (b.createdAt?.toDate() || 0) - (a.createdAt?.toDate() || 0));
        recentDocs = recentDocs.slice(0, 5);

        if (recentDocs.length === 0) {
          container.innerHTML = '<p class="text-muted">No documents found</p>';
          return;
        }

        container.innerHTML = recentDocs.map(doc => `
          <div class="recent-doc-item" style="padding: 12px; border-bottom: 1px solid var(--border);">
            <div style="display: flex; justify-content: between; align-items: start;">
              <div>
                <strong>${doc.title || 'Untitled'}</strong>
                <div style="font-size: 0.875rem; color: var(--text-light); margin-top: 4px;">
                  ${doc.category} ‚Ä¢ ${doc.docType || 'Document'}
                </div>
              </div>
              <span class="badge ${getDifficultyBadge(doc.difficulty).class}">
                ${getDifficultyBadge(doc.difficulty).text}
              </span>
            </div>
          </div>
        `).join('');
      } catch (error) {
        console.error('Error loading recent documents:', error);
      }
    }

    // Document Form Functions
    function handleSubjectSelection() {
      document.querySelectorAll('.subject-option').forEach(opt => {
        opt.classList.remove('selected');
      });
      this.classList.add('selected');
      document.getElementById('docSubject').value = this.getAttribute('data-value');
    }

    function updateSlugPreview() {
      const title = document.getElementById('docTitle').value.trim();
      const slugPreview = document.getElementById('slugPreview');
      
      if (title) {
        const slug = slugify(title);
        slugPreview.textContent = `Slug: ${slug}`;
        slugPreview.className = 'small text-success mt-1';
      } else {
        slugPreview.textContent = 'Slug will be generated automatically';
        slugPreview.className = 'small text-muted mt-1';
      }
    }

    function updatePdfPreview() {
      const url = document.getElementById('docPdfUrl').value.trim();
      const previewContainer = document.getElementById('previewContainer');
      const preview = document.getElementById('pdfPreview');
      
      if (isValidUrl(url)) {
        preview.src = buildPreviewUrl(url);
        previewContainer.style.display = 'block';
      } else {
        previewContainer.style.display = 'none';
      }
    }

    function updateThumbnailPreview() {
      const url = document.getElementById('docThumbnailUrl').value.trim();
      const preview = document.getElementById('thumbnailPreview');
      
      if (isValidUrl(url)) {
        preview.src = url;
        preview.style.display = 'block';
      } else {
        preview.style.display = 'none';
      }
    }

    function updateTagDisplay() {
      const tagsInput = document.getElementById('docTags');
      const container = document.getElementById('tagContainer');
      const tags = parseTags(tagsInput.value);
      
      container.innerHTML = tags.map(tag => `
        <span class="tag">
          ${tag}
          <span class="tag-remove" onclick="removeTag('${tag}')">√ó</span>
        </span>
      `).join('');
    }

    function removeTag(tagToRemove) {
      const tagsInput = document.getElementById('docTags');
      const currentTags = parseTags(tagsInput.value);
      const newTags = currentTags.filter(tag => tag !== tagToRemove);
      tagsInput.value = newTags.join(', ');
      updateTagDisplay();
    }

    // Document Saving
    async function handleSaveDocument(e) {
      e.preventDefault();
      
      const saveBtn = document.getElementById('saveDocumentBtn');
      const status = document.getElementById('formStatus');
      
      try {
        saveBtn.innerHTML = '<div class="spinner"></div> Saving...';
        saveBtn.disabled = true;

        const documentData = collectFormData();
        
        if (!validateDocumentData(documentData)) {
          return;
        }

        // Generate unique slug
        const baseSlug = slugify(documentData.title) || 'document-' + Date.now();
        const finalSlug = await generateUniqueSlug(baseSlug, documentData.subjectArea);
        documentData.slug = finalSlug;

        // Add timestamps
        documentData.createdAt = firebase.firestore.FieldValue.serverTimestamp();
        documentData.updatedAt = firebase.firestore.FieldValue.serverTimestamp();
        documentData.createdBy = currentUser.email;

        console.log('Saving document:', documentData);
        
        // Save to Firestore
        await db.collection(documentData.subjectArea).doc(finalSlug).set(documentData);
        
        showFormStatus('Document saved successfully!', 'success');
        clearDocumentForm();
        loadDashboardData();
        
      } catch (error) {
        console.error('Error saving document:', error);
        showFormStatus('Error saving document: ' + error.message, 'error');
      } finally {
        saveBtn.innerHTML = '<i class="fas fa-save"></i> Save Document';
        saveBtn.disabled = false;
      }
    }

    function collectFormData() {
      return {
        title: document.getElementById('docTitle').value.trim(),
        description: document.getElementById('docDescription').value.trim(),
        subjectArea: document.getElementById('docSubject').value,
        docType: document.getElementById('docType').value,
        difficulty: document.getElementById('docDifficulty').value,
        pages: document.getElementById('docPages').value ? parseInt(document.getElementById('docPages').value) : null,
        fileSize: document.getElementById('docFileSize').value ? parseFloat(document.getElementById('docFileSize').value) : null,
        language: document.getElementById('docLanguage').value,
        author: document.getElementById('docAuthor').value.trim(),
        timeframe: document.getElementById('docTimeframe').value,
        currencyPairs: document.getElementById('docCurrencyPairs').value.trim(),
        publishedDate: document.getElementById('docPublishedDate').value,
        rating: document.getElementById('docRating').value ? parseInt(document.getElementById('docRating').value) : null,
        tags: parseTags(document.getElementById('docTags').value),
        pdfUrl: document.getElementById('docPdfUrl').value.trim(),
        thumbnailUrl: document.getElementById('docThumbnailUrl').value.trim() || null,
        keyPoints: parseKeyPoints(document.getElementById('docKeyPoints').value),
        prerequisites: document.getElementById('docPrerequisites').value.trim(),
        previewUrl: buildPreviewUrl(document.getElementById('docPdfUrl').value.trim())
      };
    }

    function validateDocumentData(data) {
      if (!data.title) {
        showFormStatus('Document title is required', 'error');
        return false;
      }
      if (!data.subjectArea) {
        showFormStatus('Subject area is required', 'error');
        return false;
      }
      if (!data.pdfUrl || !isValidUrl(data.pdfUrl)) {
        showFormStatus('Valid PDF URL is required', 'error');
        return false;
      }
      return true;
    }

    function showFormStatus(message, type) {
      const status = document.getElementById('formStatus');
      status.textContent = message;
      status.className = `status ${type}`;
      status.style.display = 'block';
      
      setTimeout(() => {
        status.style.display = 'none';
      }, 5000);
    }

    function clearDocumentForm() {
      document.getElementById('documentForm').reset();
      document.querySelectorAll('.subject-option').forEach(opt => opt.classList.remove('selected'));
      document.querySelector('.subject-option[data-value="forex-trading"]').classList.add('selected');
      document.getElementById('docSubject').value = 'forex-trading';
      document.getElementById('previewContainer').style.display = 'none';
      document.getElementById('thumbnailPreview').style.display = 'none';
      document.getElementById('tagContainer').innerHTML = '';
      updateSlugPreview();
      setDefaultDate();
    }

    // Document Management
    async function loadDocumentsTable() {
      try {
        const tbody = document.getElementById('documentsTable');
        tbody.innerHTML = '<tr><td colspan="6" class="text-center">Loading documents...</td></tr>';

        const categories = ['forex-trading', 'technical-analysis', 'fundamental-analysis', 'risk-management', 'trading-psychology'];
        allDocuments = [];

        for (const category of categories) {
          const snapshot = await db.collection(category).get();
          snapshot.forEach(doc => {
            allDocuments.push({
              id: doc.id,
              category: category,
              ...doc.data()
            });
          });
        }

        displayDocuments(allDocuments);
      } catch (error) {
        console.error('Error loading documents:', error);
        document.getElementById('documentsTable').innerHTML = 
          '<tr><td colspan="6" class="text-center text-error">Error loading documents</td></tr>';
      }
    }

    function displayDocuments(documents) {
      const tbody = document.getElementById('documentsTable');
      
      if (documents.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted">No documents found</td></tr>';
        return;
      }

      tbody.innerHTML = documents.map(doc => `
        <tr>
          <td>
            <strong>${doc.title || 'Untitled'}</strong>
            ${doc.author ? `<br><small class="text-muted">by ${doc.author}</small>` : ''}
          </td>
          <td>
            <span class="badge badge-primary">${doc.category.replace('-', ' ')}</span>
          </td>
          <td>${doc.docType || 'Document'}</td>
          <td>
            <span class="badge ${getDifficultyBadge(doc.difficulty).class}">
              ${getDifficultyBadge(doc.difficulty).text}
            </span>
          </td>
          <td>
            ${doc.rating ? '‚≠ê'.repeat(doc.rating) : 'Not rated'}
          </td>
          <td>
            <button class="btn btn-sm btn-secondary" onclick="editDocument('${doc.category}', '${doc.id}')">
              <i class="fas fa-edit"></i>
            </button>
            <button class="btn btn-sm btn-danger" onclick="deleteDocument('${doc.category}', '${doc.id}', '${doc.title}')">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
      `).join('');
    }

    function filterDocuments() {
      const searchTerm = document.getElementById('searchDocuments').value.toLowerCase();
      const filtered = allDocuments.filter(doc => 
        doc.title.toLowerCase().includes(searchTerm) ||
        (doc.description && doc.description.toLowerCase().includes(searchTerm)) ||
        (doc.author && doc.author.toLowerCase().includes(searchTerm)) ||
        (doc.tags && doc.tags.some(tag => tag.toLowerCase().includes(searchTerm)))
      );
      displayDocuments(filtered);
    }

    // Utility Functions
    function slugify(text) {
      return text
        .toString()
        .toLowerCase()
        .trim()
        .replace(/\s+/g, '-')
        .replace(/[^\w\-]+/g, '')
        .replace(/\-\-+/g, '-')
        .replace(/^-+/, '')
        .replace(/-+$/, '');
    }

    function generateUniqueSlug(baseSlug, category, counter = 1) {
      const slug = counter === 1 ? baseSlug : `${baseSlug}-${counter}`;
      const docRef = db.collection(category).doc(slug);
      
      return docRef.get().then(docSnap => {
        if (!docSnap.exists) return slug;
        return generateUniqueSlug(baseSlug, category, counter + 1);
      });
    }

    function isValidUrl(url) {
      try {
        new URL(url);
        return true;
      } catch {
        return false;
      }
    }

    function buildPreviewUrl(rawUrl) {
      if (!rawUrl) return "";
      const match = rawUrl.match(/\/d\/([a-zA-Z0-9_-]{10,})/);
      if (match) {
        return `https://drive.google.com/file/d/${match[1]}/preview`;
      }
      if (rawUrl.includes("onedrive.live.com")) {
        return rawUrl.replace("redir?", "embed?") + "&download=1";
      }
      if (rawUrl.endsWith(".pdf") || rawUrl.includes(".pdf?")) {
        return rawUrl;
      }
      return `https://docs.google.com/gview?url=${encodeURIComponent(rawUrl)}&embedded=true`;
    }

    function parseTags(tagString) {
      return tagString.split(',')
        .map(tag => tag.trim())
        .filter(tag => tag.length > 0)
        .slice(0, 10);
    }

    function parseKeyPoints(keyPointsText) {
      return keyPointsText.split('\n')
        .filter(line => line.trim().length > 0)
        .map(line => line.replace(/^[‚Ä¢\-]\s*/, '').trim());
    }

    function getDifficultyBadge(difficulty) {
      const styles = {
        beginner: { class: 'badge-success', text: 'Beginner' },
        intermediate: { class: 'badge-warning', text: 'Intermediate' },
        advanced: { class: 'badge-error', text: 'Advanced' },
        expert: { class: 'badge-primary', text: 'Expert' }
      };
      return styles[difficulty] || { class: 'badge-primary', text: 'All Levels' };
    }

    function setDefaultDate() {
      document.getElementById('docPublishedDate').value = new Date().toISOString().split('T')[0];
    }

    // Global functions for table actions
    window.editDocument = async function(category, docId) {
      alert(`Edit functionality for ${docId} in ${category} would be implemented here.`);
      // Implementation would load document data into form for editing
    };

    window.deleteDocument = async function(category, docId, title) {
      if (confirm(`Are you sure you want to delete "${title}"? This action cannot be undone.`)) {
        try {
          await db.collection(category).doc(docId).delete();
          showFormStatus(`Document "${title}" deleted successfully`, 'success');
          loadDocumentsTable();
          loadDashboardData();
        } catch (error) {
          console.error('Error deleting document:', error);
          showFormStatus('Error deleting document: ' + error.message, 'error');
        }
      }
    };
  </script>
</body>
</html>